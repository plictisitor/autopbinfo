/* 8EfxDG3jy ily traian cq5OW3CPs */ #include <bits/stdc++.h>/* 8EfxDG3jy ily traian cq5OW3CPs */ using namespace std;/* 8EfxDG3jy ily traian cq5OW3CPs */ /* 8EfxDG3jy ily traian cq5OW3CPs */ ifstream cin("divtrei.in");/* 8EfxDG3jy ily traian cq5OW3CPs */ ofstream cout("divtrei.out");/* 8EfxDG3jy ily traian cq5OW3CPs */ /* 8EfxDG3jy ily traian cq5OW3CPs */ int n , k , f[3] , a[3] , b[3] , c;/* 8EfxDG3jy ily traian cq5OW3CPs */ /* 8EfxDG3jy ily traian cq5OW3CPs */ int main()/* 8EfxDG3jy ily traian cq5OW3CPs */ {/* 8EfxDG3jy ily traian cq5OW3CPs */     cin >> n >> k;/* 8EfxDG3jy ily traian cq5OW3CPs */     for(int i = 1 ; i <= n ; i++)/* 8EfxDG3jy ily traian cq5OW3CPs */     {/* 8EfxDG3jy ily traian cq5OW3CPs */         cin >> c;/* 8EfxDG3jy ily traian cq5OW3CPs */         f[c % 3]++;/* 8EfxDG3jy ily traian cq5OW3CPs */     }/* 8EfxDG3jy ily traian cq5OW3CPs */     a[0] = f[0];/* 8EfxDG3jy ily traian cq5OW3CPs */     a[1] = f[1];/* 8EfxDG3jy ily traian cq5OW3CPs */     a[2] = f[2];/* 8EfxDG3jy ily traian cq5OW3CPs */     for(int i = 2 ; i <= k ; i++)/* 8EfxDG3jy ily traian cq5OW3CPs */     {/* 8EfxDG3jy ily traian cq5OW3CPs */         b[0] = a[0] * f[0] + a[1] * f[2] + a[2] * f[1];/* 8EfxDG3jy ily traian cq5OW3CPs */         b[1] = a[0] * f[1] + a[1] * f[0] + a[2] * f[2];/* 8EfxDG3jy ily traian cq5OW3CPs */         b[2] = a[0] * f[2] + a[1] * f[1] + a[2] * f[0];/* 8EfxDG3jy ily traian cq5OW3CPs */         a[0] = b[0] % 4001 ;/* 8EfxDG3jy ily traian cq5OW3CPs */         a[1] = b[1] % 4001 ;/* 8EfxDG3jy ily traian cq5OW3CPs */         a[2] = b[2] % 4001 ;/* 8EfxDG3jy ily traian cq5OW3CPs */     }/* 8EfxDG3jy ily traian cq5OW3CPs */     cout << a[0];/* 8EfxDG3jy ily traian cq5OW3CPs */     return 0;/* 8EfxDG3jy ily traian cq5OW3CPs */ }